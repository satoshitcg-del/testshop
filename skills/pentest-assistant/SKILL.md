---
name: pentest-assistant
description: Penetration Testing Assistant for authorized security assessments and vulnerability testing. Use when performing authorized penetration testing, security audits, vulnerability assessments, or learning security testing methodologies. Supports web application testing, API security testing, reconnaissance, and report generation. ONLY use for systems you own or have explicit written permission to test.
---

# Penetration Testing Assistant

Authorized security testing assistant for web applications, APIs, and networks.

## ‚ö†Ô∏è IMPORTANT: Authorized Testing Only

This skill is for **authorized security testing only**:
- ‚úÖ Systems you own
- ‚úÖ Systems with explicit written authorization
- ‚úÖ Lab environments designed for testing
- ‚úÖ Bug bounty programs you are registered in

**Never use on systems without permission.**

---

## üéØ Testing Methodologies

### 1. Web Application Testing (OWASP Top 10)

| Test Category | Tools | Techniques |
|--------------|-------|------------|
| Injection (SQL, NoSQL, OS) | sqlmap, manual testing | Input validation, parameterized queries |
| Broken Authentication | Burp Suite, custom scripts | Brute force, session management |
| Sensitive Data Exposure | curl, wget | SSL/TLS analysis, data leakage |
| XML External Entities (XXE) | Burp Suite | XML parser testing |
| Broken Access Control | browser, curl | IDOR, privilege escalation |
| Security Misconfiguration | nmap, nikto | Default configs, unnecessary features |
| XSS | XSStrike, manual testing | Stored, reflected, DOM-based |
| Insecure Deserialization | custom scripts | Object injection |
| Known Vulnerabilities | nuclei, nmap | CVE checking |
| Insufficient Logging | manual review | Log analysis |

### 2. API Security Testing

```bash
# Common API tests
# 1. Authentication bypass
curl -H "Authorization: invalid" https://api.target.com/admin

# 2. IDOR test
curl https://api.target.com/users/123  # try other IDs

# 3. Rate limiting
curl -X POST https://api.target.com/login -d "user=test&pass=test"

# 4. Method override
curl -X DELETE https://api.target.com/users/123 -H "X-HTTP-Method-Override: GET"
```

### 3. Reconnaissance

```bash
# Subdomain enumeration
gobuster dns -d target.com -w wordlist.txt

# Directory discovery
gobuster dir -u https://target.com -w wordlist.txt

# Technology detection
whatweb https://target.com

# Port scanning
nmap -sV -sC target.com
```

---

## üìã Testing Workflow

### Phase 1: Reconnaissance
1. Identify scope and targets
2. Gather subdomain information
3. Discover endpoints and technologies
4. Map attack surface

### Phase 2: Vulnerability Discovery
1. Automated scanning (nuclei, nikto)
2. Manual testing per OWASP categories
3. Business logic testing
4. Authentication/authorization testing

### Phase 3: Exploitation
1. Verify vulnerabilities (proof of concept)
2. Assess impact and severity
3. Document steps to reproduce

### Phase 4: Reporting
1. Executive summary
2. Technical findings with evidence
3. Risk ratings and CVSS scores
4. Remediation recommendations

---

## üîß Using Scripts

Scripts are in `scripts/` directory:

| Script | Purpose | Usage |
|--------|---------|-------|
| `recon.sh` | Basic reconnaissance | `bash scripts/recon.sh target.com` |
| `api-test.sh` | API security tests | `bash scripts/api-test.sh https://api.target.com` |
| `report-template.md` | Report template | Copy and customize |

---

## üìö References

See `references/` directory:

- `owasp-top10.md` - OWASP Top 10 details with test cases
- `api-security-checklist.md` - API security testing checklist
- `cvss-scoring.md` - CVSS scoring guide
- `report-examples.md` - Sample vulnerability reports

---

## üõ†Ô∏è Integration with OpenClaw Tools

### Web Testing
```javascript
// Recon with web_search
web_search({ query: "site:target.com filetype:pdf" })

// Fetch endpoints
web_fetch({ url: "https://target.com/robots.txt" })

// Browser automation
browser({ action: "open", targetUrl: "https://target.com/login" })
browser({ action: "act", request: { kind: "fill", fields: [{ ref: "username", text: "test" }] } })
```

### Command Execution
```javascript
// Run security tools
exec({ command: "nmap -sV target.com", timeout: 300 })
exec({ command: "sqlmap -u 'https://target.com/search?q=test' --batch", timeout: 600 })
```

---

## üìù Report Template

See `scripts/report-template.md` for full template. Key sections:

1. **Executive Summary** - High-level findings for management
2. **Scope** - What was tested
3. **Methodology** - How testing was performed
4. **Findings** - Detailed vulnerabilities
5. **Risk Matrix** - Visual risk assessment
6. **Remediation** - Fix recommendations
7. **Appendix** - Evidence screenshots, logs

---

## üéì Learning Resources

- PortSwigger Web Security Academy
- OWASP Testing Guide
- HackTheBox / TryHackMe labs
- Bug bounty platforms (HackerOne, Bugcrowd)

---

*Remember: With great power comes great responsibility. Only test what you own or have permission to test.*
