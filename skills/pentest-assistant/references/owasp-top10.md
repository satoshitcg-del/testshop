# OWASP Top 10 - Detailed Testing Guide

## A01:2021 - Broken Access Control

### Test Cases
1. **Bypassing Authentication**
   - Access admin pages without login
   - Modify cookies/tokens to escalate privileges
   - Test for direct object references (IDOR)

2. **Privilege Escalation**
   - Horizontal: Access other users' data
   - Vertical: Gain admin access from user account

3. **Force Browsing**
   - Access unlinked pages
   - Directory traversal

### Tools
- Burp Suite
- Browser DevTools
- Custom scripts

---

## A02:2021 - Cryptographic Failures

### Test Cases
1. **Data Transmission**
   - Check SSL/TLS version
   - Verify certificate validity
   - Test for mixed content

2. **Data at Rest**
   - Check password hashing (bcrypt, Argon2)
   - Verify encryption of sensitive data
   - Test for hardcoded secrets

3. **Sensitive Data Exposure**
   - Error messages revealing stack traces
   - Debug information in responses
   - Source code comments

### Tools
- SSL Labs SSL Test
- Nmap SSL scripts
- GitLeaks

---

## A03:2021 - Injection

### SQL Injection
```sql
-- Basic tests
' OR '1'='1
' UNION SELECT null,null,null--
' AND 1=1--
' AND 1=2--

-- Error-based
' AND 1=CONVERT(int, (SELECT @@version))--

-- Time-based blind
'; WAITFOR DELAY '0:0:5'--
```

### Command Injection
```bash
# Basic tests
curl "https://target.com/ping?host=8.8.8.8;id"
curl "https://target.com/ping?host=8.8.8.8|whoami"
```

### Tools
- sqlmap
- Commix
- Burp Suite

---

## A04:2021 - Insecure Design

### Test Cases
1. **Business Logic Flaws**
   - Price manipulation
   - Workflow bypass
   - Race conditions

2. **Rate Limiting**
   - Brute force attacks
   - Resource exhaustion

---

## A05:2021 - Security Misconfiguration

### Test Cases
1. **Default Credentials**
   - admin/admin, admin/password
   - Check for default configs

2. **Unnecessary Features**
   - Enabled debug mode
   - Unnecessary HTTP methods
   - Directory listing enabled

3. **Security Headers**
   - X-Frame-Options
   - Content-Security-Policy
   - X-XSS-Protection

### Tools
- Nmap
- Nikto
- Mozilla Observatory

---

## A06:2021 - Vulnerable and Outdated Components

### Test Cases
1. **Version Detection**
   - Identify frameworks/libraries
   - Check for known CVEs

2. **Dependency Scanning**
   - npm audit
   - OWASP Dependency Check

### Tools
- Nuclei
- retire.js
- snyk

---

## A07:2021 - Identification and Authentication Failures

### Test Cases
1. **Credential Stuffing**
   - Test leaked credentials
   - Check for account enumeration

2. **Brute Force**
   - No rate limiting
   - Weak password policy

3. **Session Management**
   - Predictable session IDs
   - Missing HttpOnly/Secure flags
   - Session fixation

### Tools
- Hydra
- Burp Intruder
- Custom scripts

---

## A08:2021 - Software and Data Integrity Failures

### Test Cases
1. **Insecure Deserialization**
   - Java serialized objects
   - PHP unserialize
   - Pickle in Python

2. **CI/CD Security**
   - Unsigned updates
   - Insecure dependencies

---

## A09:2021 - Security Logging and Monitoring Failures

### Test Cases
1. **Insufficient Logging**
   - Failed login attempts not logged
   - Missing access logs

2. **Log Integrity**
   - Log injection
   - Missing integrity checks

---

## A10:2021 - Server-Side Request Forgery (SSRF)

### Test Cases
```http
# Basic tests
GET /fetch?url=https://internal-server/admin
GET /fetch?url=file:///etc/passwd
GET /fetch?url=http://169.254.169.254/latest/meta-data/

# Bypasses
GET /fetch?url=http://0177.0.0.1/  # Octal
GET /fetch?url=http://2130706433/  # Decimal
```

### Tools
- Burp Collaborator
- Custom scripts

---

## Additional Tests

### CORS Misconfiguration
```http
Origin: https://attacker.com
Access-Control-Allow-Origin: https://attacker.com
Access-Control-Allow-Credentials: true
```

### CSRF
- Missing anti-CSRF tokens
- Weak token validation
- Bypass with XHR

### Clickjacking
- Missing X-Frame-Options
- Weak CSP frame-ancestors
