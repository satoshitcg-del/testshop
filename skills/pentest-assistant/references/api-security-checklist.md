# API Security Testing Checklist

## Authentication

- [ ] Test for weak authentication (no auth required)
- [ ] Test credential stuffing
- [ ] Test brute force protection
- [ ] Test for JWT weaknesses (none algorithm, weak signing)
- [ ] Test API key exposure in URLs
- [ ] Test session management (expiration, rotation)

## Authorization

- [ ] Test IDOR (Insecure Direct Object Reference)
- [ ] Test horizontal privilege escalation
- [ ] Test vertical privilege escalation
- [ ] Test for missing authorization on endpoints
- [ ] Test role-based access control (RBAC)

## Input Validation

- [ ] SQL Injection in parameters
- [ ] NoSQL Injection (MongoDB, etc.)
- [ ] Command Injection
- [ ] XML External Entity (XXE)
- [ ] Server-Side Request Forgery (SSRF)
- [ ] Path Traversal
- [ ] Mass Assignment

## HTTP Methods

- [ ] Test unsupported methods (PUT, DELETE, PATCH)
- [ ] Test method override headers
- [ ] Test for CORS misconfiguration
- [ ] Test for security headers

## Rate Limiting

- [ ] Test rate limiting on authentication
- [ ] Test rate limiting on sensitive operations
- [ ] Test resource exhaustion

## Data Exposure

- [ ] Check for excessive data exposure
- [ ] Check for sensitive data in error messages
- [ ] Check for debug information
- [ ] Check for stack traces in responses

## Content Types

- [ ] Test Content-Type manipulation
- [ ] Test for XXE via JSON to XML conversion
- [ ] Test for content sniffing

## Versioning

- [ ] Test deprecated API versions
- [ ] Check for version information disclosure

## Documentation

- [ ] Check for exposed API documentation
- [ ] Check for hidden endpoints in docs
- [ ] Test endpoints not in documentation

## File Uploads

- [ ] Test file type validation
- [ ] Test file size limits
- [ ] Test for path traversal in filenames
- [ ] Test for malicious file uploads

## Business Logic

- [ ] Test workflow bypass
- [ ] Test for race conditions
- [ ] Test for price manipulation
- [ ] Test for quantity manipulation

## Tools

```bash
# Common API testing tools

# Burp Suite (GUI)
# Postman with tests
# OWASP ZAP

# Command line
httpie
curl

# Automated scanning
arjun        # Parameter discovery
postman      # Collection runner
newman       # CLI for Postman

# Fuzzing
ffuf
wfuzz
```

## Test Examples

### IDOR Test
```bash
# Test different user IDs
curl -H "Authorization: Bearer TOKEN" \
  https://api.target.com/users/1

curl -H "Authorization: Bearer TOKEN" \
  https://api.target.com/users/2

# Test with UUIDs
curl -H "Authorization: Bearer TOKEN" \
  https://api.target.com/orders/550e8400-e29b-41d4-a716-446655440000
```

### Authentication Bypass
```bash
# Test without token
curl https://api.target.com/admin/users

# Test with invalid token
curl -H "Authorization: Bearer invalid" \
  https://api.target.com/admin/users

# Test with null/empty
curl -H "Authorization: null" \
  https://api.target.com/admin/users
```

### Method Override
```bash
# Test with headers
curl -X GET -H "X-HTTP-Method-Override: DELETE" \
  https://api.target.com/users/123

# Test with _method parameter
curl -X POST -d "_method=DELETE" \
  https://api.target.com/users/123
```

### Mass Assignment
```bash
# Try adding admin field
curl -X POST https://api.target.com/users \
  -H "Content-Type: application/json" \
  -d '{"username":"test","password":"test","isAdmin":true}'

# Try role escalation
curl -X POST https://api.target.com/users \
  -H "Content-Type: application/json" \
  -d '{"username":"test","password":"test","role":"admin"}'
```
