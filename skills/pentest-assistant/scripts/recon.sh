#!/bin/bash
# Basic Reconnaissance Script
# Usage: ./recon.sh target.com

TARGET=$1

if [ -z "$TARGET" ]; then
    echo "Usage: $0 <target.com>"
    exit 1
fi

echo "=== Reconnaissance for $TARGET ==="
echo "Started: $(date)"
echo ""

# Create output directory
mkdir -p recon-$TARGET
cd recon-$TARGET

# DNS Enumeration
echo "[*] DNS Enumeration..."
host $TARGET > dns.txt 2>/dev/null
nslookup $TARGET >> dns.txt 2>/dev/null
dig $TARGET ANY >> dns.txt 2>/dev/null

# Subdomain enumeration (if tools available)
echo "[*] Subdomain Enumeration..."
if command -v subfinder &> /dev/null; then
    subfinder -d $TARGET -o subdomains.txt 2>/dev/null
fi

# Technology detection
echo "[*] Technology Detection..."
if command -v whatweb &> /dev/null; then
    whatweb https://$TARGET -v > tech.txt 2>/dev/null
else
    curl -s -I https://$TARGET | grep -i "server\|x-powered-by\|via" > tech.txt
fi

# robots.txt and sitemap
echo "[*] Checking robots.txt and sitemap..."
curl -s https://$TARGET/robots.txt > robots.txt 2>/dev/null
curl -s https://$TARGET/sitemap.xml > sitemap.xml 2>/dev/null

# Security headers
echo "[*] Checking Security Headers..."
curl -s -I https://$TARGET > headers.txt 2>/dev/null

# Port scan (top 100 ports)
echo "[*] Port Scanning (top 100)..."
if command -v nmap &> /dev/null; then
    nmap -sV --top-ports 100 $TARGET -oN nmap.txt 2>/dev/null
fi

# SSL/TLS scan
echo "[*] SSL/TLS Analysis..."
if command -v sslscan &> /dev/null; then
    sslscan $TARGET > sslscan.txt 2>/dev/null
elif command -v nmap &> /dev/null; then
    nmap --script ssl-enum-ciphers -p 443 $TARGET > sslscan.txt 2>/dev/null
fi

echo ""
echo "=== Reconnaissance Complete ==="
echo "Results saved in: recon-$TARGET/"
echo "Finished: $(date)"
